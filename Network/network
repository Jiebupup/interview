1.概述
计网分类：
分布范围：广域网WAN，局域网LAN，城域网MAN，个域网PAN
传输技术：广播式，点对点
拓扑结构：星形，总线形，环形，网状形
交换技术：电路交换，报文交换，分组交换

计网性能指标：带宽，时延，时延带宽积，往返时延RTT，吞吐量，速率

计算机网络体系结构：
协议，接口，服务（下层为上层），PDU=SDU+PCI

五层协议：物理层（比特），数据链路层（帧），网络层（数据报），传输层（报文段，用户数据报），应用层
OSI：物理层，数据链路层，网络层，传输层，会话层，表示层，应用层
TCP/IP：网络接口层，网际层，运输层，应用层

2.物理层
通信基础：
通信方式：单工、半双工和全双工。
数据传输速率：奈奎斯特定理，香农定理
编码（数字信号）和调制（模拟信号）：曼切斯特编码，幅移键控ASK，脉码调制PCM，频分复用FDM
分组交换：数据报，虚电路

传输介质：双绞线，同轴电缆，光纤，无线传输介质
设备：中继器，集线器Hub

3.数据链路层
组帧：比特填充法
差错检测：循环冗余码CRC

流量控制：滑动窗口，停等协议，后退N帧GBN，选择重传SR
可靠传输：确认和超时重传

CSMA/CD：先听后发，边听边发，冲突停发，随机重发
CSMA/CA

以太网：星型拓扑结构局域网，MAC帧结构，MAC地址用于唯一标识网络适配器（网卡）

广域网：PPP协议，HDLC协议
设备：网桥，交换机
虚拟局域网

4.网络层
路由算法：距离向量算法，链路状态算法
路由协议：内部网关协议RIP（距离向量UDP）和OSPF（链路状态IP），外部网关协议BGP（路径向量TCP）

IP数据报首部，分片
IP地址分类，网络地址转换NAT，子网划分，无分类编址CIDR
网络地址转换NAT：专用网本地 IP 转换为全球 IP

IP协议：地址解析协议ARP，网际控制报文协议ICMP，网际组管理协议IGMP，动态主机配置协议DHCP
地址解析协议ARP：由 IP 地址得到 MAC 地址。RARP。

网际控制报文协议ICMP：分为差错报告报文和询问报文。
ping用来测试两台主机之间的连通性，ICMP Echo报文。主机向目标机发送一个ICMP包，目标机收到后，调换原地址和目标地址，再发送回来。根据时间和成功响应的次数估计丢包率和网络时延。
Traceroute用来跟踪一个分组从源点到终点的路径。

IPv6，IP组播，移动IP，虚拟专用网VPN
路由器功能：路由选择和分组转发。

5.传输层
套接字=IP地址+端口号
UDP：无连接的，尽最大可能交付，没有拥塞控制，面向报文（对于应用程序传下来的报文不合并也不拆分，只是添加 UDP 首部），支持一对一、一对多、多对一和多对多的交互通信。只在IP数据报服务上增加了复用和差错检测。
TCP：面向连接的，提供可靠交付，有流量控制，拥塞控制，提供全双工通信，面向字节流（把应用层传下来的报文看成字节流，把字节流组织成大小不等的数据块），每一条 TCP 连接只能是点对点的（一对一）。

UDP首部：源端口、目的端口、长度、检验和，12 字节的伪首部是为了计算检验和临时添加的。
TCP首部：源端口、目的端口、序号、确认号、首部长度、位、窗口、检验和、选项。

TCP三次握手：采用C/S方式，第三次握手是为了防止失效的连接请求到达服务器，让服务器错误打开连接。
序号seq，确认号ack，SYN和ACK，ack=seq+1

四次挥手：序号seq，确认号ack，FIN和ACK
Client:FIN_WAIT_1->FIN_WAIT_2->TIME_WAIT
Server:CLOSE_WAIT->LAST_ACK->CLOSED

先服务器收到连接释放报文，进入CLOSE_WAIT（被动关闭）状态，服务器仍可发数据到客户。这个状态是为了让服务器端发送还未传送完毕的数据，传送完毕之后，服务器会发送 FIN 连接释放报文。
TIME_WAIT（主动关闭）：客户收到连接释放报文要等2MSL才能进入关闭，两个原因：
确保最后一个确认报文能够到达。如果服务器没收到客户端发送来的确认报文，那么就会重新发送连接释放请求报文。客户端等待一段时间就是为了重发可能丢失的ACK报文。
等待一段时间是为了让本连接持续时间内所产生的所有报文都从网络中消失，使得下一个新的连接不会出现旧的连接请求报文。

TCP可靠传输：建立在字节流上的序号，确认，超时重传。
TCP 滑动窗口是缓存的一部分
TCP 流量控制：通过控制窗口大小

TCP 拥塞控制：慢开始、拥塞避免、快重传、快恢复。拥塞窗口，发送窗口，接收窗口。

6.应用层
网络应用模型：客户-服务器C/S，对等P2P
域名系统DNS（UDP）：递归与迭代域名解析，
文件传输协议FTP（TCP）：控制连接和数据连接
电子邮件协议：发送SMTP，接收POP3，MIME
超文本传输协议HTTP，Wireshark捕获HTTP请求报文
远程登录协议TELNET

web页面请求过程：DHCP 配置主机信息，ARP 解析 MAC 地址，DNS 解析域名，HTTP 请求页面

7.输入一个 url 并回车（Web 页面请求过程）
浏览器查找域名的IP地址。DNS查找过程（UDP、53号端口）：本地hosts文件，本地DNS缓存，本地DNS服务器区域文件和缓存，未采用转发模式（迭代）或采用转发模式（递归）完成服务器之间的查找（本地域名服务器、根域名服务器、顶级域名服务器、权限域名服务器）。
浏览器发起端口80的TCP连接。三次握手。
浏览器给服务器发送一个HTTP请求。HTTP方法。
服务器接收并处理请求，返回响应。HTTP状态码。
浏览器解析并显示HTML。

高并发下，为满足低响应时间和高吞吐量，伸缩性、扩展性、可用性、安全性等要求，网站普遍使用缓存和集群等技术。
缓存减轻服务器的压力并降低响应时间。
集群使用负载均衡器将请求转发到集群中的某个服务器上，避免单一服务器的负载压力过大导致性能降低。


UDP丢包问题解决：包多的时候，要能保证接收端在收到数据后能立刻再次回到监听状态，委托回调；每个包不要携带过长的数据量，可以拆分成若干小包后在每个包头前编号；降低发送方发送包的速度。
UDP实现可靠传输：在应用层实现重传，确认和序号机制（利用包）。
TCP包最大1500B，UDP包最大64KB。
TCP协议是有状态的，有限自动机。

1.概述
计网分类：
分布范围：广域网WAN，局域网LAN，城域网MAN，个域网PAN
传输技术：广播式，点对点
拓扑结构：星形，总线形，环形，网状形
交换技术：电路交换，报文交换，分组交换

计网性能指标：带宽，时延，时延带宽积，往返时延RTT，吞吐量，速率

计算机网络体系结构：
协议，接口，服务（下层为上层），PDU=SDU+PCI

五层协议：物理层（比特），数据链路层（帧），网络层（数据报），传输层（报文段，用户数据报），应用层
OSI：物理层，数据链路层，网络层，传输层，会话层，表示层，应用层
TCP/IP：网络接口层，网际层，运输层，应用层

2.物理层
通信基础：
通信方式：单工、半双工和全双工。
数据传输速率：奈奎斯特定理，香农定理
编码（数字信号）和调制（模拟信号）：曼切斯特编码，幅移键控ASK，脉码调制PCM，频分复用FDM
分组交换：数据报，虚电路

传输介质：双绞线，同轴电缆，光纤，无线传输介质
设备：中继器，集线器Hub

3.数据链路层
组帧：比特填充法
差错检测：循环冗余码CRC

流量控制：滑动窗口，停等协议，后退N帧GBN，选择重传SR
可靠传输：确认和超时重传

CSMA/CD：先听后发，边听边发，冲突停发，随机重发
CSMA/CA

以太网：星型拓扑结构局域网，MAC帧结构，MAC地址用于唯一标识网络适配器（网卡）
虚拟局域网

广域网：PPP协议，HDLC协议
设备：网桥，交换机

4.网络层
IP数据报首部，分片
IP地址分类，网络地址转换NAT，子网划分，无分类编址CIDR
网络地址转换NAT：专用网本地 IP 转换为全球 IP

IP协议：地址解析协议ARP，网际控制报文协议ICMP，网际组管理协议IGMP，动态主机配置协议DHCP
地址解析协议ARP：由 IP 地址得到 MAC 地址。RARP。

网际控制报文协议ICMP：分为差错报告报文和询问报文。
ICMP Echo报文。类型 0 表示响应，类型 8 表示请求。
ping用来探测主机到主机之间是否可通信。基于Echo请求和应答报文，主机向目标机发送请求，目标机收到发送应答。也可以用来估计往返时间和丢包率。                          
Traceroute用来侦测主机到目的主机之间所经路由情况。通过TTL减为0和主机不可达的ICMP报文实现。

路由算法：距离向量算法，链路状态算法
路由协议：内部网关协议RIP（距离向量UDP）和OSPF（链路状态IP），外部网关协议BGP（路径向量TCP）

IPv6，IP组播，移动IP，虚拟专用网VPN
路由器功能：路由选择和分组转发。

5.传输层
端到端
多路分解与多路复用：TCP与UDP分解不同，两个具有不同源IP或源端口号的到达的TCP报文段将被重定向到两个不同的套接字。服务器主机可以支持很多并行的TCP套接字，每一个套接字和一个进程相联系，并由其四元组（源IP地址、源端口号，目的IP地址，目的端口号）来标识每一个套接字。     
套接字=IP地址+端口号
UDP：无连接的，尽最大可能交付，没有拥塞控制，面向报文（对于应用程序传下来的报文不合并也不拆分，只是添加 UDP 首部），支持一对一、一对多、多对一和多对多的交互通信。只在IP数据报服务上增加了复用和差错检测。
TCP：面向连接的，提供可靠交付，有流量控制，拥塞控制，提供全双工通信，面向字节流（把应用层传下来的报文看成字节流，把字节流组织成大小不等的数据块），每一条 TCP 连接只能是点对点的（一对一）。

UDP首部：源端口、目的端口、长度、检验和，12 字节的伪首部是为了计算检验和临时添加的。8B首部。
TCP首部：源端口、目的端口、序号、确认号、首部长度、位、窗口、检验和、选项。20B首部。

TCP三次握手：序号seq，确认号ack，SYN和ACK，ack=seq+1
第三次握手是为了防止失效的连接请求到达服务器，让服务器错误打开连接。
SYN 洪泛攻击：典型的DoS拒绝服务攻击，攻击客户端在短时间内伪造大量不存在的IP地址，向服务器不断地发送SYN包，服务器回复确认包，并等待客户的确认。由于源地址是不存在的，服务器需要不断的重发直至超时，这些伪造的SYN包将长时间占用未连接队列，正常的SYN请求被丢弃，导致目标系统运行缓慢，严重者会引起网络堵塞甚至系统瘫痪。

四次挥手：序号seq，确认号ack，FIN和ACK
Client:FIN_WAIT_1->FIN_WAIT_2->TIME_WAIT->CLOSED
Server:CLOSE_WAIT->LAST_ACK->CLOSED
TCP状态转移图

先服务器收到连接释放报文，进入CLOSE_WAIT（被动关闭）状态，服务器仍可发数据到客户。这个状态是为了让服务器端发送还未传送完毕的数据，传送完毕之后，服务器会发送 FIN 连接释放报文。
TIME_WAIT（主动关闭）：客户收到连接释放报文要等2MSL才能进入关闭，两个原因：
确保最后一个确认报文能够到达。如果服务器没收到客户端发送来的确认报文，那么就会重新发送连接释放请求报文。客户端等待一段时间就是为了重发可能丢失的ACK报文。
等待一段时间是为了让本连接持续时间内所产生的所有报文都从网络中消失，使得下一个新的连接不会出现旧的连接请求报文。

TCP可靠传输：建立在字节流上的序号，确认，超时重传。
TCP 滑动窗口是缓存的一部分
TCP 流量控制：通过控制窗口大小

TCP 拥塞控制：慢开始、拥塞避免、快重传、快恢复。拥塞窗口，发送窗口，接收窗口。

TCP KeepAlive保活机制：连接的另一方并不知道对端的情况，为了避免资源浪费，隔一段时间给连接对端发送一个探测包，如果收到对方回应的 ACK，则认为连接还是存活的，在超过一定重试次数之后还是没有收到对方的回应，则丢弃该 TCP 连接。

6.应用层
网络应用模型：客户-服务器C/S，对等P2P
域名系统DNS（UDP）：递归与迭代域名解析。域名服务器层级：权限域名服务器->顶级域名服务器->根域名服务器。
文件传输协议FTP（TCP）：控制连接和数据连接
电子邮件协议：发送SMTP，接收POP3，MIME
超文本传输协议HTTP，Wireshark捕获HTTP请求报文
远程登录协议TELNET

7.输入一个 url 并回车（Web 页面请求过程）
DHCP配置主机信息：假设主机最开始没有 IP 地址以及其它信息，那么就需要先使用 DHCP 来获取。
ARP解析MAC地址。
浏览器查找域名的IP地址。DNS查找过程（UDP、53号端口）：本地hosts文件，本地DNS缓存，本地DNS服务器区域文件和缓存，未采用转发模式（迭代）或采用转发模式（递归）完成服务器之间的查找（本地域名服务器、根域名服务器、顶级域名服务器、权限域名服务器）。                 
浏览器发起端口80的TCP连接。三次握手。
浏览器给服务器发送一个HTTP请求。HTTP方法。
服务器接收并处理请求，返回响应。HTTP状态码。
浏览器解析并显示HTML。

高并发下，为满足低响应时间和高吞吐量，伸缩性、扩展性、可用性、安全性等要求，网站普遍使用缓存和集群等技术。
缓存是将图片、视频、js 等静态资源存储在用户比较容易获取到的位置，从而减轻服务器的压力并降低响应时间。
集群是将多台服务器组成一个整体，并使用负载均衡器将请求转发到集群中的某个服务器上，避免单一服务器的负载压力过大导致性能降低。


UDP实现可靠传输：在应用层实现重传，确认和序号机制（利用包）。
TCP包最大1500B，UDP包最大64KB。
TCP协议是有状态的，有限自动机。
